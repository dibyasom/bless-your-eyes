{"id":"node_modules/popmotion/reactions/value.js","dependencies":[{"name":"/home/divyu/Documents/GitHub/bless-your-eyes/node_modules/popmotion/reactions/value.js.map","includedInParent":true,"mtime":1525955812000},{"name":"/home/divyu/Documents/GitHub/bless-your-eyes/node_modules/popmotion/src/reactions/value.ts","includedInParent":true,"mtime":1520683537000},{"name":"/home/divyu/Documents/GitHub/bless-your-eyes/package.json","includedInParent":true,"mtime":1611669448384},{"name":"/home/divyu/Documents/GitHub/bless-your-eyes/node_modules/popmotion/package.json","includedInParent":true,"mtime":1611669448356},{"name":"framesync","loc":{"line":13,"column":26},"parent":"/home/divyu/Documents/GitHub/bless-your-eyes/node_modules/popmotion/reactions/value.js","resolved":"/home/divyu/Documents/GitHub/bless-your-eyes/node_modules/framesync/dist/framesync.es.js"},{"name":"../calc","loc":{"line":14,"column":21},"parent":"/home/divyu/Documents/GitHub/bless-your-eyes/node_modules/popmotion/reactions/value.js","resolved":"/home/divyu/Documents/GitHub/bless-your-eyes/node_modules/popmotion/calc.js"},{"name":"./","loc":{"line":15,"column":17},"parent":"/home/divyu/Documents/GitHub/bless-your-eyes/node_modules/popmotion/reactions/value.js","resolved":"/home/divyu/Documents/GitHub/bless-your-eyes/node_modules/popmotion/reactions/index.js"}],"generated":{"js":"\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar framesync_1 = require(\"framesync\");\nvar calc_1 = require(\"../calc\");\nvar _1 = require(\"./\");\nvar isValueList = function (v) { return Array.isArray(v); };\nvar isSingleValue = function (v) {\n    var typeOfV = typeof v;\n    return (typeOfV === 'string' || typeOfV === 'number');\n};\nvar ValueReaction = (function (_super) {\n    __extends(ValueReaction, _super);\n    function ValueReaction(props) {\n        var _this = _super.call(this, props) || this;\n        _this.scheduleVelocityCheck = function () { return framesync_1.onFrameEnd(_this.velocityCheck); };\n        _this.velocityCheck = function () {\n            if (framesync_1.currentFrameTime() !== _this.lastUpdated) {\n                _this.prev = _this.current;\n            }\n        };\n        _this.prev = _this.current = props.value || 0;\n        if (isSingleValue(_this.current)) {\n            _this.updateCurrent = function (v) { return _this.current = v; };\n            _this.getVelocityOfCurrent = function () { return _this.getSingleVelocity(_this.current, _this.prev); };\n        }\n        else if (isValueList(_this.current)) {\n            _this.updateCurrent = function (v) { return _this.current = v.slice(); };\n            _this.getVelocityOfCurrent = function () { return _this.getListVelocity(); };\n        }\n        else {\n            _this.updateCurrent = function (v) {\n                _this.current = {};\n                for (var key in v) {\n                    if (v.hasOwnProperty(key)) {\n                        _this.current[key] = v[key];\n                    }\n                }\n            };\n            _this.getVelocityOfCurrent = function () { return _this.getMapVelocity(); };\n        }\n        if (props.initialSubscription)\n            _this.subscribe(props.initialSubscription);\n        return _this;\n    }\n    ValueReaction.prototype.create = function (props) {\n        return new ValueReaction(props);\n    };\n    ValueReaction.prototype.get = function () {\n        return this.current;\n    };\n    ValueReaction.prototype.getVelocity = function () {\n        return this.getVelocityOfCurrent();\n    };\n    ValueReaction.prototype.update = function (v) {\n        _super.prototype.update.call(this, v);\n        this.prev = this.current;\n        this.updateCurrent(v);\n        this.timeDelta = framesync_1.timeSinceLastFrame();\n        this.lastUpdated = framesync_1.currentFrameTime();\n        framesync_1.onFrameEnd(this.scheduleVelocityCheck);\n    };\n    ValueReaction.prototype.subscribe = function (observerCandidate) {\n        var sub = _super.prototype.subscribe.call(this, observerCandidate);\n        this.update(this.current);\n        return sub;\n    };\n    ValueReaction.prototype.getSingleVelocity = function (current, prev) {\n        return (typeof current === 'number' && typeof prev === 'number')\n            ? calc_1.speedPerSecond(current - prev, this.timeDelta)\n            : calc_1.speedPerSecond(parseFloat(current) - parseFloat(prev), this.timeDelta) || 0;\n    };\n    ValueReaction.prototype.getListVelocity = function () {\n        var _this = this;\n        return this.current.map(function (c, i) { return _this.getSingleVelocity(c, _this.prev[i]); });\n    };\n    ValueReaction.prototype.getMapVelocity = function () {\n        var velocity = {};\n        for (var key in this.current) {\n            if (this.current.hasOwnProperty(key)) {\n                velocity[key] = this.getSingleVelocity(this.current[key], this.prev[key]);\n            }\n        }\n        return velocity;\n    };\n    return ValueReaction;\n}(_1.BaseMulticast));\nexports.ValueReaction = ValueReaction;\nexports.default = function (value, initialSubscription) { return new ValueReaction({ value: value, initialSubscription: initialSubscription }); };\n"},"sourceMaps":{"js":{"version":3,"file":"value.js","sourceRoot":"","sources":["../src/reactions/value.ts"],"names":[],"mappings":"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","sourcesContent":["import { timeSinceLastFrame, currentFrameTime, onFrameEnd } from 'framesync';\nimport { speedPerSecond } from '../calc';\nimport { ObserverCandidate, ObserverProps, Update } from '../observer/types';\nimport { BaseMulticast } from './';\nimport { HotSubscription } from './types';\n\nexport type ValueMap = { [key: string]: number | string };\nexport type ValueList = Array<number | string>;\nexport type Value = number | string | ValueMap | ValueList;\n\nexport type ValueProps = ObserverProps & {\n  value: Value,\n  initialSubscription?: Update\n};\n\nconst isValueList = (v: any): v is ValueList => Array.isArray(v);\nconst isSingleValue = (v: any): v is string | number => {\n  const typeOfV = typeof v;\n  return (typeOfV === 'string' || typeOfV === 'number');\n};\n\nexport class ValueReaction extends BaseMulticast<ValueReaction> {\n  public updateCurrent: (v: any) => any;\n  public getVelocityOfCurrent: () => any;\n\n  private prev: Value;\n  private current: Value;\n  private timeDelta: number;\n  private lastUpdated: number;\n\n  constructor(props: ValueProps) {\n    super(props);\n    this.prev = this.current = props.value || 0;\n\n    if (isSingleValue(this.current)) {\n      this.updateCurrent = (v: number | string) => this.current = v;\n      this.getVelocityOfCurrent = () => this.getSingleVelocity(\n        this.current as string | number, this.prev as string | number\n      );\n\n    } else if (isValueList(this.current)) {\n      this.updateCurrent = (v: ValueList) => this.current = [...v];\n      this.getVelocityOfCurrent = () => this.getListVelocity();\n\n    } else {\n      this.updateCurrent = (v: ValueMap) => {\n        this.current = {};\n        for (const key in v) {\n          if (v.hasOwnProperty(key)) {\n            this.current[key] = v[key];\n          }\n        }\n      };\n      this.getVelocityOfCurrent = () => this.getMapVelocity();\n    }\n\n    if (props.initialSubscription) this.subscribe(props.initialSubscription);\n  }\n\n  create(props: ValueProps) {\n    return new ValueReaction(props);\n  }\n\n  get() {\n    return this.current;\n  }\n\n  getVelocity() {\n    return this.getVelocityOfCurrent();\n  }\n\n  update(v: Value) {\n    super.update(v);\n    this.prev = this.current;\n    this.updateCurrent(v);\n    this.timeDelta = timeSinceLastFrame();\n    this.lastUpdated = currentFrameTime();\n    onFrameEnd(this.scheduleVelocityCheck);\n  }\n\n  scheduleVelocityCheck = () => onFrameEnd(this.velocityCheck);\n\n  velocityCheck = () => {\n    if (currentFrameTime() !== this.lastUpdated) {\n      this.prev = this.current;\n    }\n  }\n\n  subscribe(observerCandidate: ObserverCandidate): HotSubscription {\n    const sub = super.subscribe(observerCandidate);\n    this.update(this.current);\n\n    return sub;\n  }\n\n  private getSingleVelocity(current: number | string, prev: number | string): number {\n    return (typeof current === 'number' && typeof prev === 'number')\n      ? speedPerSecond(current - prev, this.timeDelta)\n      : speedPerSecond(parseFloat(current as string) - parseFloat(prev as string), this.timeDelta) || 0;\n  }\n\n  private getListVelocity() {\n    return (this.current as ValueList).map(\n      (c: number | string, i: number) => this.getSingleVelocity(c, (this.prev as ValueList)[i])\n    );\n  }\n\n  private getMapVelocity() {\n    const velocity: ValueMap = {};\n    for (const key in this.current as ValueMap) {\n      if (this.current.hasOwnProperty(key)) {\n        velocity[key] = this.getSingleVelocity(\n          (this.current as ValueMap)[key], (this.prev as ValueMap)[key]\n        );\n      }\n    }\n    return velocity;\n  }\n}\n\nexport default (value: Value, initialSubscription?: Update) => new ValueReaction({ value, initialSubscription });\n"]}},"error":null,"hash":"026b8c6469568f4a2221a38efffc38d4","cacheData":{"env":{}}}